dplyr::arrange(Confounder) %>%
dplyr::rename("GWAS ID" = "confounder",
"Outcome" = "outcome") %>%
dplyr::mutate("Associated SNPs" = dplyr::case_when(
Confounder == "BMI" ~ " ",
Confounder == "Impedance of leg (right)"       ~ "rs10050092, rs12646525",
Confounder == "Impedance of leg (left)"        ~ "rs10050092, rs12646525",
Confounder == "Impedance of arm (right)"       ~ "rs10050092",
Confounder == "Impedance of arm (left)"        ~ "rs10050092",
Confounder == "Impedance of whole body"        ~ "rs10050092",
Confounder == "Standing height"                ~ "rs10050092",
Confounder == "Plateletcrit"                   ~ "rs66887589, ",
Confounder == "Myeloid white cell count"       ~ "rs10050092, rs66887589",
Confounder == "Platelet count"                 ~ "rs10050092",
Confounder == "White blood cell count"         ~ "rs66887589",
Confounder == "Coronary artery disease"        ~ "rs66887589, rs80223330",
Confounder == "Granulocyte count"              ~ "rs66887589",
Confounder == "Sum basophil neutrophil counts" ~ "rs66887589")
) %>%
dplyr::relocate("Confounder", .after = "Outcome") %>%
dplyr::relocate("GWAS ID",    .after = "Confounder") %>%
dplyr::relocate("Associated SNPs", .after = "GWAS ID") %>%
dplyr::mutate(OR = round(exp(beta_IVWcorrel), digits = 2)) %>%
dplyr::mutate(SE = round(se_IVWcorrel.random, digits = 2)) %>%
dplyr::mutate(`P-Value` = round(p_IVWcorrel.random, digits = 2)) %>%
dplyr::select(-tidyselect::contains("IVWcorrel"), -n_snp, -F_stat, -exposure)
tab
tab <- read.table(paste0(pathResults,"TwoStepMR/twostepMR.txt"), header = TRUE) %>%
dplyr::filter(outcome == "Lambert") %>%
dplyr::distinct() %>%
dplyr::relocate(outcome) %>%
dplyr::mutate("Confounder" = dplyr::case_when(
confounder == "ukb-b-19953" ~ "BMI",
confounder == "ukb-b-7376"  ~ "Impedance of leg (right)",
confounder == "ukb-b-14068" ~ "Impedance of leg (left)",
confounder == "ukb-b-7859"  ~ "Impedance of arm (right)",
confounder == "ukb-b-19379" ~ "Impedance of arm (left)",
confounder == "ukb-b-19921" ~ "Impedance of whole body",
confounder == "ukb-b-10787" ~ "Standing height",
confounder == "ebi-a-GCST004607" ~ "Plateletcrit",
confounder == "ebi-a-GCST004626" ~ "Myeloid white cell count",
confounder == "ukb-d-30080_irnt" ~ "Platelet count",
confounder == "ieu-b-30" ~ "White blood cell count",
confounder == "ebi-a-GCST005195" ~ "Coronary artery disease",
confounder == "ebi-a-GCST004614" ~ "Granulocyte count",
confounder == "ebi-a-GCST004620" ~ "Sum basophil neutrophil counts"
)) %>%
dplyr::mutate(OR = exp(beta_IVWcorrel),
cilow  = exp(beta_IVWcorrel-1.96*se_IVWcorrel.random),
cihigh = exp(beta_IVWcorrel+1.96*se_IVWcorrel.random)) %>%
dplyr::mutate(Confounder = factor(Confounder, labels = Confounder)) %>%
dplyr::select("Confounder", "OR", "cilow", "cihigh") %>%
dplyr::union_all(or)
tab <- read.table(paste0(pathResults,"TwoStepMR/twostepMR.txt"), header = TRUE) %>%
dplyr::filter(outcome == "Lambert") %>%
dplyr::distinct() %>%
dplyr::relocate(outcome) %>%
dplyr::mutate("Confounder" = dplyr::case_when(
confounder == "ukb-b-19953" ~ "BMI",
confounder == "ukb-b-7376"  ~ "Impedance of leg (right)",
confounder == "ukb-b-14068" ~ "Impedance of leg (left)",
confounder == "ukb-b-7859"  ~ "Impedance of arm (right)",
confounder == "ukb-b-19379" ~ "Impedance of arm (left)",
confounder == "ukb-b-19921" ~ "Impedance of whole body",
confounder == "ukb-b-10787" ~ "Standing height",
confounder == "ebi-a-GCST004607" ~ "Plateletcrit",
confounder == "ebi-a-GCST004626" ~ "Myeloid white cell count",
confounder == "ukb-d-30080_irnt" ~ "Platelet count",
confounder == "ieu-b-30" ~ "White blood cell count",
confounder == "ebi-a-GCST005195" ~ "Coronary artery disease",
confounder == "ebi-a-GCST004614" ~ "Granulocyte count",
confounder == "ebi-a-GCST004620" ~ "Sum basophil neutrophil counts"
)) %>%
dplyr::mutate(OR = exp(beta_IVWcorrel),
cilow  = exp(beta_IVWcorrel-1.96*se_IVWcorrel.random),
cihigh = exp(beta_IVWcorrel+1.96*se_IVWcorrel.random)) %>%
dplyr::mutate(Confounder = factor(Confounder, labels = Confounder)) %>%
dplyr::select("Confounder", "OR", "cilow", "cihigh") %>%
dplyr::arrange(Confounder) %>%
dplyr::union_all(or)
tab
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = Confounder)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(limits = rev)
tab <- read.table(paste0(pathResults,"TwoStepMR/twostepMR.txt"), header = TRUE) %>%
dplyr::filter(outcome == "Lambert") %>%
dplyr::distinct() %>%
dplyr::relocate(outcome) %>%
dplyr::mutate("Confounder" = dplyr::case_when(
confounder == "ukb-b-19953" ~ "BMI",
confounder == "ukb-b-7376"  ~ "Impedance of leg (right)",
confounder == "ukb-b-14068" ~ "Impedance of leg (left)",
confounder == "ukb-b-7859"  ~ "Impedance of arm (right)",
confounder == "ukb-b-19379" ~ "Impedance of arm (left)",
confounder == "ukb-b-19921" ~ "Impedance of whole body",
confounder == "ukb-b-10787" ~ "Standing height",
confounder == "ebi-a-GCST004607" ~ "Plateletcrit",
confounder == "ebi-a-GCST004626" ~ "Myeloid white cell count",
confounder == "ukb-d-30080_irnt" ~ "Platelet count",
confounder == "ieu-b-30" ~ "White blood cell count",
confounder == "ebi-a-GCST005195" ~ "Coronary artery disease",
confounder == "ebi-a-GCST004614" ~ "Granulocyte count",
confounder == "ebi-a-GCST004620" ~ "Sum basophil neutrophil counts"
)) %>%
dplyr::mutate(OR = exp(beta_IVWcorrel),
cilow  = exp(beta_IVWcorrel-1.96*se_IVWcorrel.random),
cihigh = exp(beta_IVWcorrel+1.96*se_IVWcorrel.random)) %>%
dplyr::mutate(Confounder = factor(Confounder, labels = Confounder)) %>%
dplyr::select("Confounder", "OR", "cilow", "cihigh") %>%
dplyr::arrange(Confounder) %>%
dplyr::mutate(n = dplyr::row_number()+1) %>%
dplyr::union_all(or %>% dplyr::mutate(n = 1)) %>%
dplyr::arrange(Confounder)
tab
tab <- read.table(paste0(pathResults,"TwoStepMR/twostepMR.txt"), header = TRUE) %>%
dplyr::filter(outcome == "Lambert") %>%
dplyr::distinct() %>%
dplyr::relocate(outcome) %>%
dplyr::mutate("Confounder" = dplyr::case_when(
confounder == "ukb-b-19953" ~ "BMI",
confounder == "ukb-b-7376"  ~ "Impedance of leg (right)",
confounder == "ukb-b-14068" ~ "Impedance of leg (left)",
confounder == "ukb-b-7859"  ~ "Impedance of arm (right)",
confounder == "ukb-b-19379" ~ "Impedance of arm (left)",
confounder == "ukb-b-19921" ~ "Impedance of whole body",
confounder == "ukb-b-10787" ~ "Standing height",
confounder == "ebi-a-GCST004607" ~ "Plateletcrit",
confounder == "ebi-a-GCST004626" ~ "Myeloid white cell count",
confounder == "ukb-d-30080_irnt" ~ "Platelet count",
confounder == "ieu-b-30" ~ "White blood cell count",
confounder == "ebi-a-GCST005195" ~ "Coronary artery disease",
confounder == "ebi-a-GCST004614" ~ "Granulocyte count",
confounder == "ebi-a-GCST004620" ~ "Sum basophil neutrophil counts"
)) %>%
dplyr::mutate(OR = exp(beta_IVWcorrel),
cilow  = exp(beta_IVWcorrel-1.96*se_IVWcorrel.random),
cihigh = exp(beta_IVWcorrel+1.96*se_IVWcorrel.random)) %>%
dplyr::mutate(Confounder = factor(Confounder, labels = Confounder)) %>%
dplyr::select("Confounder", "OR", "cilow", "cihigh") %>%
dplyr::arrange(Confounder) %>%
dplyr::mutate(n = dplyr::row_number()+1) %>%
dplyr::union_all(or %>% dplyr::mutate(n = 1)) %>%
dplyr::arrange(n)
tab
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete()
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = rev(n))) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = rev(n))) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = n, labels = Confounder
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = rev(n))) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = rev(tab$n), labels = rev(tab$Confounder)
)
rev(tab$n)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = rev(n))) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = as.numeric(rev(tab$n)),
labels = rev(tab$Confounder)
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = rev(n))) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = tab$n),
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = rev(n))) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = tab$n,
labels = rev(tab$Confounder)
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = rev(n))) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = tab$n,
labels = rev(tab$Confounder)
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = tab$n,
labels = tab$Confounder
) +
ggplot2::scale_y_reverse()
tab$Confounder
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = tab$n,
labels = !!tab$Confounder
) +
ggplot2::scale_y_reverse()
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = tab$n,
labels = tab$Confounder
) +
ggplot2::scale_y_reverse()
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(breaks = tab$n,
labels = Confounder
) +
ggplot2::scale_y_reverse()
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(ggplot2::aes(labels = Confounders, breaks = n)
) +
ggplot2::scale_y_reverse()
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(ggplot2::aes(
breaks = n,
labels = Confounders)
) +
ggplot2::scale_y_reverse()
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(ggplot2::aes(
breaks = n,
labels = Confounders)
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(ggplot2::aes(
breaks = n,
labels = Confounders
),
limits = rev()
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(
ggplot2::aes(breaks = n,labels = Confounders)
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(
breaks = n,
labels = Confounders
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(
breaks = tab$n,
labels = Confounders
)
ggplot2::ggplot(data = tab, ggplot2::aes(x = OR, y = n)) +
ggplot2::geom_point(
ggplot2::aes(x = OR),
shape = 15, size = 3
) +
ggplot2::geom_errorbar(
ggplot2::aes(xmin = cilow, xmax = cihigh),
width = 0.5
) +
ggplot2::geom_vline(
xintercept = 1,
linetype   = "dashed"
) +
ggplot2::scale_y_discrete(
breaks = tab$n,
labels = tab$Confounders
)
a <- c(tab$Confounder = tab$n)
a
a <- c(as.charactertab$Confounder) = as.character(tab$n))
a <- c(as.character(tab$Confounder) = as.character(tab$n))
dplyr::n(or)
or  <- read.table(paste0(pathResults,"MR_Results/MR_Results_DBP_scaled.txt"), header = TRUE) %>%
dplyr::filter(outcome == "Lambert") %>%
dplyr::mutate("Confounder" = "Main analysis") %>%
dplyr::select("Confounder", "OR", "cilow", "cihigh")
dplyr::n(or)
dplyr::n_row(or)
n_row(or)
length(or)
width(or)
nrow(or)
or
a <- c()
a
