"eaf.exposure"           = "Freq1"
) %>%
dplyr::mutate(
"exposure" = "DBP",
"id.exposure" = "DBP"
) %>%
dplyr::mutate(
effect_allele.exposure = toupper(effect_allele.exposure),
other_allele.exposure  = toupper(other_allele.exposure)
)
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/BP_Evangelou_2018/Evangelou_30224653_DBP.txt/Evangelou_30224653_DBP.txt'))) %>%
tidyr::separate(MarkerName, into=c('chr','pos','Type'), sep =':') %>%
dplyr::mutate(pos = as.numeric(pos)) %>%
dplyr::filter(chr == 4 & pos >= gene_start-window & pos <= gene_end+window, Type == "SNP") %>%
dplyr::filter(chr == 4, Type == "SNP") %>%
dplyr::select(
"chr", "pos",
"effect_allele.exposure" = "Allele1",
"other_allele.exposure"  = "Allele2",
"pval.exposure"          = "P",
"samplesize.exposure"    = "TotalSampleSize",
"beta.exposure"          = "Effect",
"se.exposure"            = "StdErr",
"eaf.exposure"           = "Freq1"
) %>%
dplyr::mutate(
"exposure" = "DBP",
"id.exposure" = "DBP"
) %>%
dplyr::mutate(
effect_allele.exposure = toupper(effect_allele.exposure),
other_allele.exposure  = toupper(other_allele.exposure)
)
# Map to SNP ID
# map positions to snp ID
snpMart <- biomaRt::useEnsembl("ENSEMBL_MART_SNP","hsapiens_snp", "https://feb2014.archive.ensembl.org")
gwas
myData <- gwas %>%
dplyr::summarise(
CHR = chr,
START = pos,
END   = pos
)
coords <- apply(myData, 1, paste, collapse = ":")
for(i in 1:nrow(myData)){
mapped <- biomaRt::getBM(attributes = c('refsnp_id', 'chr_name', 'chrom_start', 'chrom_end', 'allele'),
filters = c('chromosomal_region'),
values = coords[[i]],
mart = snpMart)
if(i == 1){
tab <- mapped
}else{
tab <- tab %>%
dplyr::union_all(mapped)
}
print(i)
}
coords
snpMart <- biomaRt::useEnsembl(biomart = "snps", dataset = "hsapiens_snp", "https://feb2014.archive.ensembl.org")
myData <- dat %>%
dplyr::summarise(
CHR = chr,
START = pos,
END   = pos
)
myData <- gwas %>%
dplyr::summarise(
CHR = chr,
START = pos,
END   = pos
)
coords <- apply(myData, 1, paste, collapse = ":")
for(i in 1:nrow(myData)){
mapped <- biomaRt::getBM(attributes = c('refsnp_id', 'chr_name', 'chrom_start', 'chrom_end', 'allele'),
filters = c('chromosomal_region'),
values = coords[[i]],
mart = snpMart)
if(i == 1){
tab <- mapped
}else{
tab <- tab %>%
dplyr::union_all(mapped)
}
print(i)
}
snpMart <- biomaRt::useEnsembl(biomart = "snps", dataset = "hsapiens_snp", "https://feb2014.archive.ensembl.org")
help(useEnsembl)
# Map to SNP ID
# map positions to snp ID
snpMart <- biomaRt::useEnsembl(biomart = "snps", dataset = "hsapiens_snp", GRCh = 38)
# Map to SNP ID
# map positions to snp ID
snpMart <- biomaRt::useEnsembl(biomart = "snps", dataset = "hsapiens_snp", GRCh = 37)
myData <- gwas %>%
dplyr::summarise(
CHR = chr,
START = pos,
END   = pos
)
rm(list = ls())
library("magrittr")
pathData <- 'D:/Projects/PDE5_AD_MendelianRandomisation/'
dir.create(paste0(pathData,"Results/"))
pathResults <- paste0(pathData,"Results/")
# Map to SNP ID
# map positions to snp ID
snpMart <- biomaRt::useEnsembl(biomart = "snps", dataset = "hsapiens_snp", GRCh = 37)
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/BP_Evangelou_2018/Evangelou_30224653_DBP.txt/Evangelou_30224653_DBP.txt'))) %>%
tidyr::separate(MarkerName, into=c('chr','pos','Type'), sep =':') %>%
dplyr::mutate(pos = as.numeric(pos)) %>%
dplyr::filter(chr == 4 & pos >= gene_start-window & pos <= gene_end+window, Type == "SNP") %>%
dplyr::filter(chr == 4, Type == "SNP") %>%
dplyr::select(
"chr", "pos",
"effect_allele.exposure" = "Allele1",
"other_allele.exposure"  = "Allele2",
"pval.exposure"          = "P",
"samplesize.exposure"    = "TotalSampleSize",
"beta.exposure"          = "Effect",
"se.exposure"            = "StdErr",
"eaf.exposure"           = "Freq1"
) %>%
dplyr::mutate(
"exposure" = "DBP",
"id.exposure" = "DBP"
) %>%
dplyr::mutate(
effect_allele.exposure = toupper(effect_allele.exposure),
other_allele.exposure  = toupper(other_allele.exposure)
)
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_deRojas_2021/Sumstats_SPIGAPUK2_20190625/Sumstats_SPIGAPUK2_20190625.txt'))) %>%
dplyr::select(SNP = "RS",
chr = "CHR",
effect_allele.outcome = "A1",
other_allele.outcome  = "A2",
beta.outcome          = "Beta",
se.outcome            = "SE",
pval.outcome          = "P") %>%
dplyr::mutate(id.outcome = "deRojas",
outcome    = "deRojas",
eaf.outcome = NA) %>%
dplyr::filter(chr == 4, pos >= 119494397-1, pos <= 119628804+1)
"deRojas" = {
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_deRojas_2021/Sumstats_SPIGAPUK2_20190625/Sumstats_SPIGAPUK2_20190625.txt')))
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_deRojas_2021/Sumstats_SPIGAPUK2_20190625/Sumstats_SPIGAPUK2_20190625.txt')))
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_deRojas_2021/Sumstats_SPIGAPUK2_20190625/Sumstats_SPIGAPUK2_20190625.txt')))
gwas
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_wightman_2021_excluding_23andme/PGCALZ2ExcludingUKBand23andME_METALInverseVariance_MetaAnalysis.txt.gz')))
gwas
gwas
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_Bellenguez_2022/GCST90027158_buildGRCh38.tsv.gz')))
gwas
gene_start <- 120550146
gene_end   <- 120415550
window     <- 0
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_deRojas_2021/Sumstats_SPIGAPUK2_20190625/Sumstats_SPIGAPUK2_20190625.txt')))
gwas
snp_mart <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp")
snp_ids  <- c("rs16828074", "rs17232800")
snp_attributes = c("refsnp_id", "chr_name", "chrom_start")
snp_locations = biomaRt::getBM(attributes=snp_attributes, filters="snp_filter",
values=snp_ids, mart=snp_mart)
snp_locations
listFilters(snp_mart)
biomaRt::listAttributes()
biomaRt::listAttributes(snp_mart)
biomaRt::listFilters(snp_mart)
biomaRt::attributePages(snp_mart)
biomaRt::listDatasets(snp_mart)
snp_mart <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host = "http://grch37.ensembl.org/biomart/martview/b7d49ac90e2cd10080b66d2a9904404c?VIRTUALSCHEMANAME=default&ATTRIBUTES=hsapiens_snp.default.snp.refsnp_id|hsapiens_snp.default.snp.refsnp_source|hsapiens_snp.default.snp.chr_name|hsapiens_snp.default.snp.chrom_start|hsapiens_snp.default.snp.chrom_end&FILTERS=&VISIBLEPANEL=mainpanel")
snp_mart <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host = "https://grch37.ensembl.org/biomart/martview/b7d49ac90e2cd10080b66d2a9904404c")
snp_mart <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="grch37.ensembl.org")
snp_mart <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_mart
biomaRt::listDatasets(snp_mart)
snp_mart <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_ids  <- c("rs16828074", "rs17232800")
snp_attributes = c("refsnp_id", "chr_name", "chrom_start")
snp_locations = biomaRt::getBM(attributes=snp_attributes, filters="snp_filter",
values=snp_ids, mart=snp_mart)
snp_locations
gwas
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_Bellenguez_2022/GCST90027158_buildGRCh38.tsv.gz'))) %>%
dplyr::select(SNP = "variant_id",
chr = "chromosome",
pos = "base_pair_location",
effect_allele.outcome = "effect_allele",
other_allele.outcome  = "other_allele",
beta.outcome          = "beta",
se.outcome            = "standard_error",
eaf.outcome           = "effect_allele_frequency",
pval.outcome          = "p_value") %>%
dplyr::mutate(id.outcome = "Bellenguez",
outcome    = "Bellenguez") %>%
dplyr::filter(chr == 4)
gwas
# Liftover
snp_mart       <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_attributes <- c("refsnp_id", "chr_name", "chrom_start")
for(i in 1:nrow(gwas)){
snp_locations = biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas[i],
mart       = snp_mart)
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
}
# Liftover
snp_mart       <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_attributes <- c("refsnp_id", "chr_name", "chrom_start")
for(i in 1:nrow(gwas)){
snp_locations = biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas[i],
mart       = snp_mart)
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
print(i)
}
# Liftover
snp_mart       <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_attributes <- c("refsnp_id", "chr_name", "chrom_start")
i
snp_locations = biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas[i],
mart       = snp_mart)
snp_locations = biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart)
snp_locations
biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
dplyr::filter(chr_name == 4)
for(i in 1:nrow(gwas)){
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
dplyr::filter(chr_name == 4)
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
print(i)
}
# Liftover
snp_mart       <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_attributes <- c("refsnp_id", "chr_name", "chrom_start")
for(i in 1:nrow(gwas)){
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
dplyr::filter(chr_name == 4)
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
print(paste0(i," out of ", nrow(gwas)))
}
snp_locations
mapping
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
mapping
tibble::tibble(mapping)
snp_locations
mapping %>%
dplyr::union_all(snp_locations)
tibble::tibble(mapping)
as.integer(40)
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start))
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start),
chr_name = as.integer(chr_name))
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
tibble::tibble(mapping)
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start),
chr_name = as.character(chr_name))
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
i
for(i in 391:nrow(gwas)){
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start),
chr_name = as.character(chr_name))
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
print(paste0(i," out of ", nrow(gwas)))
}
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_Bellenguez_2022/GCST90027158_buildGRCh38.tsv.gz'))) %>%
dplyr::select(SNP = "variant_id",
chr = "chromosome",
pos = "base_pair_location",
effect_allele.outcome = "effect_allele",
other_allele.outcome  = "other_allele",
beta.outcome          = "beta",
se.outcome            = "standard_error",
eaf.outcome           = "effect_allele_frequency",
pval.outcome          = "p_value") %>%
dplyr::mutate(id.outcome = "Bellenguez",
outcome    = "Bellenguez") %>%
dplyr::filter(chr == 4)
rm(list = ls())
library("magrittr")
pathData <- 'D:/Projects/PDE5_AD_MendelianRandomisation/'
dir.create(paste0(pathData,"Results/"))
pathResults <- paste0(pathData,"Results/")
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_Bellenguez_2022/GCST90027158_buildGRCh38.tsv.gz'))) %>%
dplyr::select(SNP = "variant_id",
chr = "chromosome",
pos = "base_pair_location",
effect_allele.outcome = "effect_allele",
other_allele.outcome  = "other_allele",
beta.outcome          = "beta",
se.outcome            = "standard_error",
eaf.outcome           = "effect_allele_frequency",
pval.outcome          = "p_value") %>%
dplyr::mutate(id.outcome = "Bellenguez",
outcome    = "Bellenguez") %>%
dplyr::filter(chr == 4)
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_Bellenguez_2022/GCST90027158_buildGRCh38.tsv.gz'))) %>%
dplyr::select(SNP = "variant_id",
chr = "chromosome",
pos = "base_pair_location",
effect_allele.outcome = "effect_allele",
other_allele.outcome  = "other_allele",
beta.outcome          = "beta",
se.outcome            = "standard_error",
eaf.outcome           = "effect_allele_frequency",
pval.outcome          = "p_value") %>%
dplyr::mutate(id.outcome = "Bellenguez",
outcome    = "Bellenguez") %>%
dplyr::filter(chr == 4)
rm(list = ls())
library("magrittr")
pathData <- 'D:/Projects/PDE5_AD_MendelianRandomisation/'
dir.create(paste0(pathData,"Results/"))
pathResults <- paste0(pathData,"Results/")
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_Bellenguez_2022/GCST90027158_buildGRCh38.tsv.gz'))) %>%
dplyr::select(SNP = "variant_id",
chr = "chromosome",
pos = "base_pair_location",
effect_allele.outcome = "effect_allele",
other_allele.outcome  = "other_allele",
beta.outcome          = "beta",
se.outcome            = "standard_error",
eaf.outcome           = "effect_allele_frequency",
pval.outcome          = "p_value") %>%
dplyr::mutate(id.outcome = "Bellenguez",
outcome    = "Bellenguez") %>%
dplyr::filter(chr == 4)
# Liftover
snp_mart       <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_attributes <- c("refsnp_id", "chr_name", "chrom_start")
biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart)
i <- 1
biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
tibble::tibble()
for(i in 1:nrow(gwas)){
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
tibble::tibble() %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start),
chr_name    = as.character(chr_name),
refsnp_id   = as.character(rfsnp_id))
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
print(paste0(i," out of ", nrow(gwas)))
}
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
tibble::tibble() %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start),
chr_name    = as.character(chr_name),
refsnp_id   = as.character(refsnp_id))
for(i in 1:nrow(gwas)){
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
tibble::tibble() %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start),
chr_name    = as.character(chr_name),
refsnp_id   = as.character(refsnp_id))
if(i == 1){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
print(paste0(i," out of ", nrow(gwas)))
}
mapping
readr::write_delim(mapping,"mapping.txt")
readr::write_delim(mapping,here::here("mapping.txt"))
pathData <- 'D:/Projects/PDE5_AD_MendelianRandomisation/'
dir.create(paste0(pathData,"Results/"))
pathResults <- paste0(pathData,"Results/")
rm(list = ls())
library("magrittr")
pathData <- 'D:/Projects/PDE5_AD_MendelianRandomisation/'
dir.create(paste0(pathData,"Results/"))
pathResults <- paste0(pathData,"Results/")
gwas <- tibble::as_tibble(readr::read_table(paste0(pathData,'SummaryStatistics/AlzD_Bellenguez_2022/GCST90027158_buildGRCh38.tsv.gz'))) %>%
dplyr::select(SNP = "variant_id",
chr = "chromosome",
pos = "base_pair_location",
effect_allele.outcome = "effect_allele",
other_allele.outcome  = "other_allele",
beta.outcome          = "beta",
se.outcome            = "standard_error",
eaf.outcome           = "effect_allele_frequency",
pval.outcome          = "p_value") %>%
dplyr::mutate(id.outcome = "Bellenguez",
outcome    = "Bellenguez") %>%
dplyr::filter(chr == 4)
# Liftover
snp_mart       <- biomaRt::useMart("ENSEMBL_MART_SNP", dataset="hsapiens_snp", host="https://grch37.ensembl.org")
snp_attributes <- c("refsnp_id", "chr_name", "chrom_start")
for(i in 500001:600000){
snp_locations <- biomaRt::getBM(attributes = snp_attributes,
filters    = "snp_filter",
values     = gwas$SNP[i],
mart       = snp_mart) %>%
tibble::tibble() %>%
dplyr::filter(chr_name == 4) %>%
dplyr::mutate(chrom_start = as.integer(chrom_start),
chr_name    = as.character(chr_name),
refsnp_id   = as.character(refsnp_id))
if(i == 500001){
mapping <- snp_locations
}else{
mapping <- mapping %>%
dplyr::union_all(snp_locations)
}
print(paste0(i," out of 6000000"))
}
